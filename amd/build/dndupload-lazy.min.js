/**
 * This file is part of Moodle - http://moodle.org/
 *
 * Moodle is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Moodle is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @package
 * @author    David Castro <david.castro@openlms.net>
 * @copyright Copyright (c) 2017 Open LMS
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_snap/dndupload-lazy",["jquery","core/yui","theme_snap/util","core/str"],(function($,YUI,util,str){var self=this;return self.dndupload=null,self.init=function(options){util.whenTrue((function(){return void 0!==M.course_dndupload}),(function(){self.dndupload=M.course_dndupload,YUI.use("node","event","json","anim","moodle-core-notification-alert",(function(Y){self.decorateCourseDNDUpload(Y,options)}))}),!0),new MutationObserver((()=>{const fileModalHd=document.querySelector(".moodle-dialogue-base .moodle-dialogue-hd");fileModalHd&&str.get_strings([{key:"addresourceoractivity",component:"moodle"},{key:"actionchoice",component:"moodle"}]).then((strings=>{let modalBod=document.querySelector(".moodle-dialogue-base .moodle-dialogue-bd > p").innerHTML;if(strings[1].substring(0,strings[1].indexOf("'{$a}'"))===modalBod.substring(0,modalBod.indexOf("'"))){const header=document.createElement("h5");header.innerText=strings[0],fileModalHd.prepend(header)}}))})).observe(document.body,{childList:!0})},self.decorateCourseDNDUpload=function(Y,options){"undefined"!=typeof themeSnapCourseFileHandlers&&themeSnapCourseFileHandlers?options.handlers=themeSnapCourseFileHandlers:options.handlers={};var extensions=["gif","jpe","jpg","jpeg","png","svg","svgz","webp","mp3"],newfilehandlers=[];for(var h in options.handlers.filehandlers){var handler=options.handlers.filehandlers[h];handler&&handler.module&&("label"===handler.module&&-1!==extensions.indexOf(handler.extension.toLowerCase())||newfilehandlers.push(handler))}options.handlers.filehandlers=newfilehandlers,self.dndupload.init(Y,options),$(".js-snap-drop-file").change((function(){for(var file,sectionnumber=$(this).attr("id").replace("snap-drop-file-",""),section=Y.one("#section-"+sectionnumber),i=0;i<this.files.length;i++)file=this.files.item(i),self.dndupload.handle_file(file,section,sectionnumber)}));var targetAnimImgs=document.querySelectorAll("div.content"),configAnimImgs={childList:!0,subtree:!0},observerAnimImgs=new MutationObserver((function(){util.processAnimatedImages()}));targetAnimImgs.forEach((target=>observerAnimImgs.observe(target,configAnimImgs)))},{init:self.init}}));

//# sourceMappingURL=dndupload-lazy.min.js.map