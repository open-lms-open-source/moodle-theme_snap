/**
 * Module to manage activity info in snap for tiles format
 *
 * @module     theme_snap/course_activity_info
 * @copyright  Copyright (c) 2023 Open LMS (https://www.openlms.net)
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_snap/course_activity_info",["jquery","core/ajax","theme_snap/ajax_notification"],(function($,ajax,ajaxNotify){const listenManualCompletion=function(){$(".course-content").on("submit","form.togglecompletion",(function(e){e.preventDefault();var form=$(this);if(!form.hasClass("ajaxing")){var id=$(form).find('input[name="id"]').val(),completionState=$(form).find('input[name="completionstate"]').val(),module=$(form).parents("li.snap-asset").first();form.addClass("ajaxing"),ajax.call([{methodname:"theme_snap_course_module_completion",args:{id:id,completionstate:completionState},done:function(response){$("#module-"+id+" div.manual-completion-button").html(response.completionhtml),ajaxNotify.ifErrorShowBestMsg(response).done((function(errorShown){form.removeClass("ajaxing"),errorShown||function(module,completionhtml){module.find(".snap-asset-completion-tracking").html(completionhtml),module.find(".btn-link").focus(),$(document).trigger("snapModuleCompletionChange",module)}(module,response.completionhtml)}))},fail:function(response){ajaxNotify.ifErrorShowBestMsg(response).then((function(){form.removeClass("ajaxing")}))}}],!0,!0)}}))};return{init:function(){listenManualCompletion(),$(document).on("btnready",(()=>{$(".manual-completion-button").each(((index,btn)=>{$(btn).hide();const parent=$(btn).parents().filter("#"+btn.id);parent.length>0&&parent.attr("id")===btn.id&&$(btn).show()}))}))}}}));

//# sourceMappingURL=course_activity_info.min.js.map