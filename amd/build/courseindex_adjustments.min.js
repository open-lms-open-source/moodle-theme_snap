define("theme_snap/courseindex_adjustments",["exports","core/config","core/ajax"],(function(_exports,_config,_ajax){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Additional settings in the course index.
   *
   * @module theme_snap/courseindex_adjustments
   * @copyright  Copyright (c) 2025 Open LMS
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_config=_interopRequireDefault(_config),_ajax=_interopRequireDefault(_ajax);const injectIcons=root=>{root.querySelectorAll(".activityiconcontainer[data-cmid]").forEach((container=>{var _container$closest;if(container.dataset.iconInjected)return;container.dataset.iconInjected="1";const link=null===(_container$closest=container.closest("li.courseindex-item"))||void 0===_container$closest?void 0:_container$closest.querySelector("a.courseindex-link");if(!link)return;const match=(link.getAttribute("href")||"").match(/\/mod\/([^/]+)\//);if(!match)return;const modname=match[1],iconurl=(modname=>"".concat(_config.default.wwwroot,"/theme/image.php/").concat(_config.default.theme,"/").concat(modname,"/").concat(_config.default.themerev,"/monologo?filtericon=1"))(modname),img=document.createElement("img");img.src=iconurl,img.alt="".concat(modname," icon"),img.className="".concat(modname," icon activityicon"),container.appendChild(img)}))},injectTitles=root=>{root.querySelectorAll("a.courseindex-link, a.aalink.stretched-link").forEach((link=>{if(!link.hasAttribute("title")){const text=link.textContent.trim();text&&link.setAttribute("title",text)}}))},processNode=node=>{1===node.nodeType&&(injectIcons(node),injectTitles(node))};_exports.init=()=>{injectIcons(document),injectTitles(document);const target=document.querySelector("#courseindex");if(target){new MutationObserver((mutations=>{mutations.forEach((m=>{m.addedNodes.forEach(processNode)})),(async()=>{const courseStateData=await _ajax.default.call([{methodname:"core_courseformat_get_state",args:{courseid:M.cfg.courseId}}])[0];return JSON.parse(courseStateData)})().then((courseState=>{var _courseState$section$;const sections=document.querySelectorAll("#courseindex-content .courseindex-section"),currentSectionId=null===(_courseState$section$=courseState.section.filter((el=>el.current))[0])||void 0===_courseState$section$?void 0:_courseState$section$.id;sections.forEach((section=>{currentSectionId===section.dataset.id?(section.classList.add("current"),document.querySelector("body:not(.path-course-view-section)")&&section.querySelector(".courseindex-item").classList.add("pageitem")):(section.classList.remove("current"),document.querySelector("body:not(.path-course-view-section)")&&section.querySelector(".courseindex-item").classList.remove("pageitem"))}))}));document.querySelectorAll("body:not(.path-course-view-section) #courseindex-content .courseindex-section").forEach((section=>{section.classList.contains("current")?section.querySelector(".courseindex-item").classList.add("pageitem"):section.querySelector(".courseindex-item").classList.remove("pageitem")}))})).observe(target,{childList:!0,subtree:!0})}}}));

//# sourceMappingURL=courseindex_adjustments.min.js.map