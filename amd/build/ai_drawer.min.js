define("theme_snap/ai_drawer",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/**
   * This file is part of Moodle - http://moodle.org/
   *
   * Moodle is free software: you can redistribute it and/or modify
   * it under the terms of the GNU General Public License as published by
   * the Free Software Foundation, either version 3 of the License, or
   * (at your option) any later version.
   *
   * Moodle is distributed in the hope that it will be useful,
   * but WITHOUT ANY WARRANTY; without even the implied warranty of
   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   * GNU General Public License for more details.
   *
   * You should have received a copy of the GNU General Public License
   * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
   *
   * @package
   * @author    Julian Tovar <julian.tovar@openlms.net>
   * @copyright Copyright (c) 2025 Open LMS
   * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const SELECTORS_AIDRAWER_CLOSE_BUTTON="#ai-drawer button#ai-drawer-close",SELECTORS_GOTO_TOP_LINK="#goto-top-link",SELECTORS_SIDEBAR="#snap-sidebar-menu",SELECTORS_HEADER="header",SELECTORS_DRAWER_BUTTONS=".snap-sidebar-menu-item[data-activeselector], .drawer-toggler.drawer-left-toggle [data-activeselector]",SELECTORS_AIDRAWER_BUTTON='.ai-course-summarise-controls button[aria-controls="ai-drawer"]',SELECTORS_AIDRAWER="div#ai-drawer",SELECTORS_NAV_UNPINNED="#mr-nav.headroom--unpinned",CLASSES_CUSTOM_MENU_ITEM="custom-menu-item",CLASSES_SHOW="show",CLASSES_ACTIVE="active",CLASSES_COLLAPSED="collapsed",POPOVERS_AND_DRAWERS={CLICKABLE_SELECTORS:["#user-menu-toggle","#nav-intellicart-popover-container","#nav-notification-popover-container","#local-accessibility-buttoncontainer",'.snap-sidebar-menu-item[data-activeselector="#admin-menu-trigger.active"]','.snap-sidebar-menu-item[data-activeselector="#theme_snap-drawers-blocks.show"]','.snap-sidebar-menu-item[data-activeselector="#snap_feeds_side_menu_trigger.active"]']};_exports.init=()=>{setupClickHandlers(),setupAIDrawerDynamicLayout(),setupEventListeners()};const setupAIDrawerDynamicLayout=()=>{const AIDrawerButton=document.querySelector(SELECTORS_AIDRAWER_BUTTON),header=document.querySelector(SELECTORS_HEADER);if(AIDrawerButton&&header){const AIDrawer=document.querySelector(SELECTORS_AIDRAWER);AIDrawer&&repositionHeightAndTopPosition(header,AIDrawer),window.addEventListener("scroll",(function(){const isNavUnpinned=document.querySelector(SELECTORS_NAV_UNPINNED),AIDrawer=document.querySelector(SELECTORS_AIDRAWER);AIDrawer&&(isNavUnpinned?(AIDrawer.style.top="0px",AIDrawer.style.height="100vh"):repositionHeightAndTopPosition(header,AIDrawer))}))}};function repositionHeightAndTopPosition(reference,positionedElement){const elementRect=reference.getBoundingClientRect(),visibleHeight=window.innerHeight,topPosition=Math.max(0,elementRect.bottom);positionedElement.style.top="".concat(topPosition,"px"),positionedElement.style.height="".concat(visibleHeight-topPosition,"px")}const setupClickHandlers=()=>{let isClosingDrawers=!1;const checkAndCloseAIDrawer=()=>{if(isClosingDrawers)return!1;let isOpenAIDrawer=!1;return document.querySelector(SELECTORS_AIDRAWER).classList.contains(CLASSES_SHOW)&&(isOpenAIDrawer=!0),!!isOpenAIDrawer&&(isClosingDrawers=!0,(()=>{repositionGotoTopLink();const AIDrawerButton=document.querySelector(SELECTORS_AIDRAWER_CLOSE_BUTTON);AIDrawerButton&&(AIDrawerButton.click(),AIDrawerButton.classList.remove(CLASSES_ACTIVE))})(),isClosingDrawers=!1,!0)};POPOVERS_AND_DRAWERS.CLICKABLE_SELECTORS.forEach((selector=>{const element=document.querySelector(selector);element.addEventListener("click",(()=>{checkAndCloseAIDrawer()}),!0),element.addEventListener("keydown",(e=>{"Enter"!==e.key&&13!==e.keyCode||checkAndCloseAIDrawer()}),!0)}));const checkAndCloseOtherDrawers=()=>{document.querySelectorAll(SELECTORS_DRAWER_BUTTONS).forEach((button=>{const activeSelector=button.dataset.activeselector,activeElements=document.querySelectorAll(activeSelector);if(Array.from(activeElements).some((el=>el.classList.contains(CLASSES_SHOW)||el.classList.contains(CLASSES_ACTIVE)||!el.classList.contains(CLASSES_COLLAPSED)))){if(button.classList.contains(CLASSES_CUSTOM_MENU_ITEM)){(button.querySelector("a, button")||button).click()}else button.click();button.classList.remove(CLASSES_ACTIVE)}})),setTimeout((()=>{repositionGotoTopLink()}),50)},AIDrawerButton=document.querySelector(SELECTORS_AIDRAWER_BUTTON);AIDrawerButton.addEventListener("click",(()=>{checkAndCloseOtherDrawers()}),!0),AIDrawerButton.addEventListener("keydown",(e=>{"Enter"!==e.key&&13!==e.keyCode||checkAndCloseOtherDrawers()}),!0)},setupEventListeners=()=>{window.addEventListener("scroll",(()=>{setTimeout((()=>{repositionHeightAndTopPosition(document.querySelector(SELECTORS_HEADER),document.querySelector(SELECTORS_AIDRAWER));const gotoTopLink=document.querySelector(SELECTORS_GOTO_TOP_LINK);if(gotoTopLink){"visible"===window.getComputedStyle(gotoTopLink).visibility&&repositionGotoTopLink()}}),50)}))},repositionGotoTopLink=()=>{const gotoTopLink=document.querySelector(SELECTORS_GOTO_TOP_LINK);if(!gotoTopLink)return;gotoTopLink.style.marginRight="";const sidebar=document.querySelector(SELECTORS_SIDEBAR);if(sidebar&&sidebar.classList.contains(CLASSES_SHOW)){const AIDrawer=document.querySelector(SELECTORS_AIDRAWER);if(AIDrawer&&AIDrawer.offsetWidth>0&&!AIDrawer.classList.contains("drawer-left")){const drawerWidth=AIDrawer.offsetWidth;return void(gotoTopLink.style.marginRight="".concat(drawerWidth,"px"))}}}}));

//# sourceMappingURL=ai_drawer.min.js.map