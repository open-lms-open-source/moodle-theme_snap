{"version":3,"file":"courseindex_adjustments.min.js","sources":["../src/courseindex_adjustments.js"],"sourcesContent":["define(['core/config'], function(cfg) {\n    return {\n        init: function() {\n            console.log('HOLAAAAAA1');\n\n            /**\n             * Construye la URL del ícono de un módulo usando theme/image.php\n             * (igual que get_icon_url en PHP).\n             */\n            const getIconUrl = function(modname) {\n                return cfg.wwwroot +\n                    '/theme/image.php/' +\n                    cfg.theme + '/' +\n                    modname + '/' +\n                    cfg.themerev + '/' +\n                    'monologo?filtericon=1';\n            };\n\n            /**\n             * Inyecta íconos en las actividades (CMs).\n             */\n            const injectIcons = function(root) {\n                root.querySelectorAll('.activityiconcontainer[data-cmid]').forEach(function(container) {\n                    if (container.dataset.iconInjected) {\n                        return;\n                    }\n                    console.log('HOLAAAAAA2');\n                    container.dataset.iconInjected = '1';\n\n                    const link = container.closest('a.courseindex-link');\n                    if (!link) {\n                        return;\n                    }\n\n                    const href = link.getAttribute('href') || '';\n                    const match = href.match(/\\/mod\\/([^\\/]+)\\//);\n                    if (!match) {\n                        return;\n                    }\n                    const modname = match[1];\n                    const iconurl = getIconUrl(modname);\n\n                    const img = document.createElement('img');\n                    img.src = iconurl;\n                    img.alt = modname + ' icon';\n                    img.className = 'icon activityicon';\n                    container.appendChild(img);\n                });\n            };\n\n            /**\n             * Agrega el atributo title a los enlaces del índice (secciones y CMs).\n             */\n            const injectTitles = function(root) {\n                root.querySelectorAll('a.courseindex-link').forEach(function(link) {\n                    if (!link.hasAttribute('title')) {\n                        const text = link.textContent.trim();\n                        if (text) {\n                            link.setAttribute('title', text);\n                        }\n                    }\n                });\n            };\n\n            /**\n             * Procesa un nodo nuevo (íconos + titles).\n             */\n            const processNode = function(node) {\n                if (node.nodeType !== 1) {\n                    return;\n                }\n                injectIcons(node);\n                injectTitles(node);\n            };\n\n            // Corre una vez por si ya existen nodos.\n            injectIcons(document);\n            injectTitles(document);\n\n            // Observa cambios en el índice (porque se renderiza vía JS).\n            const target = document.querySelector('#courseindex');\n            if (target) {\n                const observer = new MutationObserver(function(mutations) {\n                    mutations.forEach(function(m) {\n                        m.addedNodes.forEach(processNode);\n                    });\n                });\n                observer.observe(target, {childList: true, subtree: true});\n            }\n        }\n    };\n});\n"],"names":["define","cfg","init","console","log","injectIcons","root","querySelectorAll","forEach","container","dataset","iconInjected","link","closest","match","getAttribute","modname","iconurl","wwwroot","theme","themerev","getIconUrl","img","document","createElement","src","alt","className","appendChild","injectTitles","hasAttribute","text","textContent","trim","setAttribute","processNode","node","nodeType","target","querySelector","MutationObserver","mutations","m","addedNodes","observe","childList","subtree"],"mappings":"AAAAA,4CAAO,CAAC,gBAAgB,SAASC,WACtB,CACHC,KAAM,WACFC,QAAQC,IAAI,oBAkBNC,YAAc,SAASC,MACzBA,KAAKC,iBAAiB,qCAAqCC,SAAQ,SAASC,cACpEA,UAAUC,QAAQC,oBAGtBR,QAAQC,IAAI,cACZK,UAAUC,QAAQC,aAAe,UAE3BC,KAAOH,UAAUI,QAAQ,0BAC1BD,kBAKCE,OADOF,KAAKG,aAAa,SAAW,IACvBD,MAAM,yBACpBA,mBAGCE,QAAUF,MAAM,GAChBG,QA/BK,SAASD,gBACjBf,IAAIiB,QACP,oBACAjB,IAAIkB,MAAQ,IACZH,QAAU,IACVf,IAAImB,SAJDnB,yBA8BaoB,CAAWL,SAErBM,IAAMC,SAASC,cAAc,OACnCF,IAAIG,IAAMR,QACVK,IAAII,IAAMV,QAAU,QACpBM,IAAIK,UAAY,oBAChBlB,UAAUmB,YAAYN,SAOxBO,aAAe,SAASvB,MAC1BA,KAAKC,iBAAiB,sBAAsBC,SAAQ,SAASI,UACpDA,KAAKkB,aAAa,SAAU,OACvBC,KAAOnB,KAAKoB,YAAYC,OAC1BF,MACAnB,KAAKsB,aAAa,QAASH,WASrCI,YAAc,SAASC,MACH,IAAlBA,KAAKC,WAGThC,YAAY+B,MACZP,aAAaO,QAIjB/B,YAAYkB,UACZM,aAAaN,gBAGPe,OAASf,SAASgB,cAAc,mBAClCD,OAAQ,CACS,IAAIE,kBAAiB,SAASC,WAC3CA,UAAUjC,SAAQ,SAASkC,GACvBA,EAAEC,WAAWnC,QAAQ2B,mBAGpBS,QAAQN,OAAQ,CAACO,WAAW,EAAMC,SAAS"}