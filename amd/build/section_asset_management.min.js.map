{"version":3,"file":"section_asset_management.min.js","sources":["../src/section_asset_management.js"],"sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package\n * @copyright Copyright (c) 2015 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(\n    [\n        'jquery',\n        'core/log',\n        'core/ajax',\n        'core/str',\n        'core/templates',\n        'core/notification',\n        'theme_snap/util',\n        'theme_snap/ajax_notification',\n        'core_filters/events',\n        'core/fragment',\n        'core_courseformat/local/content/actions',\n        'core_courseformat/courseeditor',\n        'theme_snap/activity_cards',\n    ],\n    function(\n        $,\n        log,\n        ajax,\n        str,\n        templates,\n        notification,\n        util, ajaxNotify,\n        Event,\n        fragment,\n        Actions,\n        CourseEditor,\n        activityCards,\n    ) {\n\n        var self = this;\n\n\n        /**\n         * Sections that are being retrieved by the API.\n         * @type {Array}\n         */\n        var sectionsProcess = [];\n\n        /**\n         * Sets observers for the TOC drawer elements.\n         */\n        var setTocObservers = function() {\n            if (self.courseConfig.format == 'weeks' || self.courseConfig.format == 'topics') {\n                $('#toc-searchables li a').click(function(e) {\n                    var link = $(e.target);\n                    var urlParams = link.attr('href').split(\"&\"),\n                        section = urlParams[0],\n                        mod = urlParams[1] || null;\n                    section = section.split('#section-')[1];\n                    getSection(section, mod);\n                });\n            }\n        };\n\n        /**\n         * Sets observers for the TOC and Footer navigation trough sections.\n         */\n        var setNavigationObservers = function() {\n            if (self.courseConfig.format == 'weeks' || self.courseConfig.format == 'topics') {\n                var selectors = [\n                    '.section_footer a.next_section',\n                    '.section_footer a.previous_section',\n                    '#courseindex-content .courseindex-section-title a.courseindex-link' // For course index links.\n                ];\n                var $elements = $(selectors.join(', '));\n                $elements.off('click');\n                $elements.click(function(e) {\n                    var link = $(this);\n                    var section = link.attr('section-number');\n                    // For TOC, section number resides on parent div.\n                    if (!section) {\n                        // Avoid running Behat, as it behaves randomly in Gitlab.\n                        if (M.cfg.behatsiterunning) {\n                            return;\n                        }\n                        section = link.closest('.courseindex-section').attr('data-number');\n                    }\n                    if (typeof section !== 'undefined' && section.length > 0) {\n                        e.preventDefault();\n                        self.courseConfig.sectionnum = parseInt(section);\n                        getSection(section, 0);\n                    }\n                });\n                setTOCVisibleSection();\n            }\n        };\n        const setCmActionsObservers = function() {\n            const selector = '.action-menu a[data-action],' +\n                '.section-actions a[data-action],' +\n                '[data-action=\"newModule\"].section-modchooser-link';\n\n            const sections = document.querySelector('ul.sections');\n            if (sections) {\n                sections.addEventListener('click', function(e) {\n                    const actionLink = e.target.closest(selector);\n                    if (!actionLink) {\n                        return; // Do nothing.\n                    }\n                    let actionName = actionLink.dataset.action;\n\n                    // Check if we are clicking on action button, permalink & update had another observers.\n                    if (actionName === 'permalink' || actionName === 'update') {\n                        return; // Do nothing.\n                    }\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    const reactiveCourseEditor = CourseEditor.getCurrentCourseEditor();\n                    // In topics format we need to initialize the reactive component for highlight sections.\n                    if (self.courseConfig.format == 'topics') {\n                        require(\n                            ['format_topics/section',], function(SectionModule) {\n                                let editMode = reactiveCourseEditor.isEditing;\n                                // We need editing mode On, so topics module is initialized properly.\n                                reactiveCourseEditor._editing = true;\n                                SectionModule.init();\n                                reactiveCourseEditor._editing = editMode;\n                            }\n                        );\n                    }\n                    // Init observers for other section and modules actions.\n                    const actions = new Actions.prototype.constructor({\n                        element: actionLink,\n                        reactive: reactiveCourseEditor\n                    });\n                    // Handle the action.\n                    if (typeof actions._dispatchClick === 'function') {\n                        actions._dispatchClick(e);\n                        if (actionName === \"cmDelete\") {\n                            // If deleting an activity, update toc Searchable for Snap.\n                            // We should use reactive components instead.\n                            let cmid = actionLink.dataset.id;\n                            $('#toc-searchables li[data-id=\"' + cmid + '\"]').remove();\n                        }\n                    }\n                }, {capture: true});\n            }\n        };\n\n        /**\n         * Scroll to a mod via search.\n         * @param {string} modid\n         */\n        var scrollToModule = function(modid) {\n            // Sometimes we have a hash, sometimes we don't.\n            // Strip hash then add just in case.\n            $('#toc-search-results').html('');\n            var targmod = $(\"#\" + modid.replace('#', ''));\n            // http://stackoverflow.com/questions/6677035/jquery-scroll-to-element\n            util.scrollToElement(targmod);\n\n            var searchpin = $(\"#searchpin\");\n            if (!searchpin.length) {\n                searchpin = $('<i id=\"searchpin\"></i>');\n            }\n\n            $(targmod).find('.instancename').prepend(searchpin);\n            $(targmod).attr('tabindex', '-1').focus();\n        };\n\n\n        /**\n         * Mark the section shown to user with a class in the TOC.\n         */\n        var setTOCVisibleSection = function() {\n            var sectionIdSel = '.section.main.state-visible, #coursetools.state-visible, #snap-add-new-section.state-visible';\n            if (!sectionIdSel) {\n                return;\n            }\n            var currentSectionId = $(sectionIdSel).attr('data-id');\n\n            // Remove snap-visible-section class and reset aria-current to false for all sections.\n            $('#courseindex .courseindex-section').removeClass('snap-visible-section');\n            $('#courseindex .courseindex-section a.courseindex-link').attr('aria-current', 'false');\n\n            // Find the correct Section link and update class and aria-current.\n            var visibleSection = $(`#courseindex .courseindex-section[data-id=\"${currentSectionId}\"]`);\n            visibleSection.addClass('snap-visible-section');\n            visibleSection.find('a.courseindex-link').attr('aria-current', 'true');\n        };\n\n        /**\n         * Gets a specific section for the current course and if an activity module is passed sets focus on it.\n         * @param {string} section\n         * @param {string} mod\n         */\n        var getSection = function(section, mod) {\n            var node = $('ul.sections > #section-' + section);\n            if (node.length == 0 && sectionsProcess.indexOf(section) == -1) {\n                sectionsProcess.push(section);\n                var params = {courseid: self.courseConfig.id, section: section};\n                $('.sk-fading-circle').show();\n                // We need to prevent the DOM to show the default section.\n                $('.course-content .' + self.courseConfig.format + 'ul.sections > li[id^=\"section-\"]').hide();\n                fragment.loadFragment('theme_snap', 'section', self.courseConfig.contextid, params).done(function(html, js) {\n                    var node = $(html);\n                    renderSection(section, node, mod, js);\n\n                    var folders = node.find('li.snap-activity.modtype_folder');\n                    $.each(folders, function (index, folder) {\n                        var content = $(folder).find('div.contentwithoutlink div.snap-assettype');\n                        if (content.length > 0) {\n                            if ($(folder).find('div.activityinstance div.snap-header-card .asset-type').length == 0) {\n                                var folderAssetTypeHeader = $(folder).find('div.activityinstance div.snap-header-card');\n                                content.prependTo(folderAssetTypeHeader);\n                            }\n                        }\n                    });\n                });\n            } else {\n                $(window).trigger('hashchange');\n            }\n            updateBreadcrumb(section);\n        };\n\n        /**\n         * Update site breadcrumb when navigating through sections.\n         * @param {string} sectionId the ID of the current section to show.\n         */\n        var updateBreadcrumb = function(sectionId) {\n            // Use reactive Instances for getting course State.\n            const reactiveCourseEditor = CourseEditor.getCurrentCourseEditor();\n            const state = reactiveCourseEditor.state;\n\n            if (!state || !state.section) {\n                return;\n            }\n\n            // Get Visible section from State.\n            const targetSection = Array.from(state.section.values()).find(sec => sec.section == sectionId);\n            if (!targetSection) {\n                return;\n            }\n\n            let breadcrumbSections = [];\n\n            // Manage subsections.\n            if (targetSection.component === 'mod_subsection' && targetSection.parentsectionid) {\n                // Let's search for parent of subsection.\n                const parentSection = state.section.find(sec => sec.id == targetSection.parentsectionid);\n                if (parentSection) {\n                    // Add parent section to Breadcrumb.\n                    breadcrumbSections.push({\n                        id: parentSection.id,\n                        name: parentSection.title,\n                        url: parentSection.sectionurl,\n                        isCurrent: false\n                    });\n                }\n            }\n\n            // Add current section to Breadcrumb.\n            breadcrumbSections.push({\n                id: targetSection.id,\n                name: targetSection.title,\n                url: targetSection.sectionurl,\n                isCurrent: true\n            });\n\n            // Generate new HTML for section nodes.\n            let html = '';\n            breadcrumbSections.forEach(step => {\n                const ariaCurrent = step.isCurrent ? 'aria-current=\"page\"' : '';\n                html += `<li class=\"breadcrumb-item\">\n                            <a href=\"${step.url}\" ${ariaCurrent} data-section-name-for=\"${step.id}\" >${step.name}</a>\n                         </li>`;\n            });\n\n            // Inject the Breadcrumb Nodes.\n            const breadcrumbList = document.querySelector('ol.breadcrumb');\n\n            // Remove old section/s from Breadcrumb.\n            const oldDynamicItems = breadcrumbList.querySelectorAll('a[data-section-name-for]');\n            oldDynamicItems.forEach(link => {\n                const listItem = link.closest('li.breadcrumb-item');\n                if (listItem) {\n                    listItem.remove();\n                }\n            });\n            // Update or insert new sections.\n            breadcrumbList.insertAdjacentHTML('beforeend', html);\n        };\n\n        /**\n         * This functions inserts a section node to the DOM.\n         * @param {string} section\n         * @param {node} html\n         * @param {string} mod\n         * @param {string} js\n         */\n        var renderSection = function(section, html, mod, js) {\n            var anchor = $('.course-content');\n            var existingSections = [];\n            anchor.find('ul.sections>li[id^=section-]').each(function() {\n                existingSections.push(parseInt($(this).attr('id').split('section-')[1]));\n            });\n            var tempnode = $('<div></div>');\n            templates.replaceNodeContents(tempnode, html, '');\n\n            if (existingSections.length > 0) {\n                var closest = existingSections.reduce(function(prev, curr) {\n                    return (Math.abs(curr - section) < Math.abs(prev - section) ? curr : prev);\n                });\n\n                if (closest > section) {\n                    anchor.find('ul.sections > #section-' + closest).before(tempnode.contents());\n\n                } else {\n                    anchor.find('ul.sections > #section-' + closest).after(tempnode.contents());\n\n                }\n            } else {\n                $('.sk-fading-circle').after(tempnode);\n            }\n            templates.runTemplateJS(js);\n\n            // Hide loading animation.\n            $('.sk-fading-circle').hide();\n            // Notify filters about the new section.\n            Event.notifyFilterContentUpdated($('.course-content .' + self.courseConfig.format));\n            var sections = anchor.find('ul.sections>li[id^=\"section-\"]');\n            // When not present the section, the first one will be shown as default, remove all classes to prevent that.\n            sections.removeClass('state-visible');\n            var id = 'ul.sections>#section-' + section;\n            $(id).addClass('state-visible');\n            // Leave all course sections as they were.\n            sections.show();\n            setNavigationObservers();\n            activityCards.init();\n\n            // Set observer for mod chooser.\n            $(id + ' .section-modchooser-link').click(function() {\n                // Grab the section number from the button.\n                var sectionNum = $(this).attr('data-sectionid');\n                $('.snap-modchooser-addlink').each(function() {\n                    // Update section in mod link to current section.\n                    var newLink = this.href.replace(/(section=)[0-9]+/ig, '$1' + sectionNum);\n                    $(this).attr('href', newLink);\n                });\n            });\n\n            // If a module id has been passed as parameter, set focus.\n            if (mod != 0 && typeof mod !== 'undefined') {\n                scrollToModule(mod);\n            }\n        };\n\n    return {\n        init: function(courseLib) {\n\n            self.courseConfig = courseLib.courseConfig;\n\n            /**\n             * Set observers for TOC and navigation buttons in the footer.\n             */\n            var setCourseSectionObservers = function() {\n                setTocObservers();\n                setNavigationObservers();\n                // Check user is logged in, in order to use CourseEditor.\n                const isLoggedIn = document.querySelector('#snap-header  .usermenu');\n                // Only on course page.\n                const onCoursePage = document.body.classList.contains('path-course-view');\n                if (!isLoggedIn || !onCoursePage) {\n                    return; // If not, do nothing.\n                }\n                // Event listeners for Course modules actions, when editing is off.\n                const reactiveCourseEditor = CourseEditor.getCurrentCourseEditor();\n                if (!reactiveCourseEditor.isEditing) {\n                    setCmActionsObservers();\n                }\n            };\n\n            /**\n             * Add listeners.\n             */\n            var addListeners = function() {\n                setCourseSectionObservers();\n                $('body').addClass('snap-course-listening');\n            };\n\n            /**\n             * Override core functions.\n             */\n            var overrideCore = function() {\n                // Check M.course exists (doesn't exist in social format).\n                if (M.course && M.course.resource_toolbox) {\n                    /* eslint-disable camelcase */\n                    M.course.resource_toolbox.handle_resource_dim = function(button, activity, action) {\n                        return (action === 'hide') ? 0 : 1;\n                    };\n                    /* eslint-enable camelcase */\n                }\n            };\n\n            /**\n             * Initialise script.\n             */\n            var initialise = function() {\n                // Add listeners.\n                addListeners();\n\n                // Override core functions\n                util.whenTrue(function() {\n                    return M.course && M.course.init_section_toolbox;\n                }, function() {\n                    overrideCore();\n                    }, true);\n\n            };\n            initialise();\n        },\n\n        /**\n         * Exposed function that renders a specific course section and sets focus on an activity module.\n         * @param {string} section\n         * @param {string} mod\n         */\n        renderAndFocusSection: function(section, mod) {\n            getSection(section, mod);\n        },\n\n        /**\n         * Exposed function so observers can be set on TOC.\n         */\n        setNavigationObservers: function() {\n            setNavigationObservers();\n        },\n\n        /**\n         * Exposed function so Section in TOC is highlighted.\n         */\n        setTOCVisibleSection: function() {\n            setTOCVisibleSection();\n        }\n    };\n\n});\n"],"names":["define","$","log","ajax","str","templates","notification","util","ajaxNotify","Event","fragment","Actions","CourseEditor","activityCards","self","this","sectionsProcess","setNavigationObservers","courseConfig","format","$elements","join","off","click","e","link","section","attr","M","cfg","behatsiterunning","closest","length","preventDefault","sectionnum","parseInt","getSection","setTOCVisibleSection","sectionIdSel","currentSectionId","removeClass","visibleSection","addClass","find","mod","indexOf","push","params","courseid","id","show","hide","loadFragment","contextid","done","html","js","node","renderSection","folders","each","index","folder","content","folderAssetTypeHeader","prependTo","window","trigger","updateBreadcrumb","sectionId","state","getCurrentCourseEditor","targetSection","Array","from","values","sec","breadcrumbSections","component","parentsectionid","parentSection","name","title","url","sectionurl","isCurrent","forEach","step","ariaCurrent","breadcrumbList","document","querySelector","querySelectorAll","listItem","remove","insertAdjacentHTML","anchor","existingSections","split","tempnode","replaceNodeContents","reduce","prev","curr","Math","abs","before","contents","after","runTemplateJS","notifyFilterContentUpdated","sections","init","sectionNum","newLink","href","replace","modid","targmod","scrollToElement","searchpin","prepend","focus","scrollToModule","courseLib","setCourseSectionObservers","urlParams","target","isLoggedIn","onCoursePage","body","classList","contains","isEditing","addEventListener","actionLink","actionName","dataset","action","stopPropagation","reactiveCourseEditor","require","SectionModule","editMode","_editing","actions","prototype","constructor","element","reactive","_dispatchClick","cmid","capture","setCmActionsObservers","whenTrue","course","init_section_toolbox","resource_toolbox","handle_resource_dim","button","activity","renderAndFocusSection"],"mappings":"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"}