{"version":3,"file":"accessibility.min.js","sources":["../src/accessibility.js"],"sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle. If not, see <http://www.gnu.org/licenses/>.\n *\n * @package\n * @module    theme_snap/accessibility\n * @author    Oscar Nadjar oscar.nadjar@openlms.net\n * @copyright Copyright (c) 2019 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * JS code to assign attributes and expected behavior for elements in the Dom regarding accessibility.\n */\ndefine(['jquery', 'core/str', 'core/event', 'core_form/events', 'theme_boost/bootstrap/tools/sanitizer', 'theme_boost/popover',\n    'core/moremenu', 'core/log'],\n    function($, str, Event, FormEvents, { DefaultWhitelist }, Popover, coreMoreMenu, log) {\n        return {\n            snapAxInit: function(localJouleGrader, allyReport, blockReports, localCatalogue) {\n\n                /**\n                 * Module to get the strings from Snap to add the aria-label attribute to new accessibility features.\n                 */\n                str.get_strings([\n                    {key: 'accessforumstringdis', component: 'theme_snap'},\n                    {key: 'accessforumstringmov', component: 'theme_snap'},\n                    {key: 'calendar', component: 'calendar'},\n                    {key: 'accessglobalsearchstring', component: 'theme_snap'},\n                    {key: 'viewcalendar', component: 'theme_snap'},\n                    {key: 'viewmyfeedback', component: 'theme_snap'},\n                    {key: 'viewmessaging', component: 'theme_snap'},\n                    {key: 'viewforumposts', component: 'theme_snap'},\n                    {key: 'editcoursesettings', component: 'theme_snap'},\n                    {key: 'gradebook', component: 'local_joulegrader'},\n                    {key: 'gradebook', component: 'core_grades'},\n                    {key: 'numparticipants', component: 'core_message'},\n                    {key: 'pld', component: 'theme_snap'},\n                    {key: 'competencies', component: 'core_competency'},\n                    {key: 'outcomes', component: 'core_outcome'},\n                    {key: 'badges', component: 'core_badges'},\n                    {key: 'coursereport', component: 'report_allylti'},\n                    {key: 'pluginname', component: 'local_catalogue'},\n                    {key: 'experimental', component: 'block_reports'}\n                ]).done(function(stringsjs) {\n                    if ($(\"#page-mod-forum-discuss\")) {\n                        $(\"div[data-content='forum-discussion'] select.custom-select.singleselect\")\n                        .attr(\"aria-label\", stringsjs[0]);\n                        $(\"div[data-content='forum-discussion'] div.movediscussionoption \" +\n                            \"select.custom-select.urlselect\").attr(\"aria-label\", stringsjs[1]);\n                    }\n                    $(\"i.fa-calendar\").parent().attr(\"aria-label\", stringsjs[2]);\n                    $(\"input[name='TimeEventSelector[calendar]']\").attr('aria-label', stringsjs[2]);\n                    var searchbutton = $(\"#mr-nav .simplesearchform a.btn.btn-open\");\n                    $(searchbutton).attr({\n                        title: stringsjs[3],\n                        'aria-label': stringsjs[3],\n                    });\n\n                    // Add needed ID's for course dashboard.\n                    // These ID's were added for the most used elements in the course dashboard.\n\n                    // There is not a lang string that contains {$a} participants with capital P, and this function helps with that.\n                    // Taken from https://css-tricks.com/snippets/jquery/make-jquery-contains-case-insensitive/\n                    $.expr[\":\"].contains = $.expr.createPseudo(function(arg) {\n                        return function(elem) {\n                            return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;\n                        };\n                    });\n                    var ctparticipantsnumber = stringsjs[11].split(\" \");\n                    $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[8] + '\")')\n                        .attr(\"id\", \"ct-course-settings\");\n                    $('section#coursetools ul#coursetools-list a:contains(\"' + ctparticipantsnumber[1] + '\")')\n                        .attr(\"id\", \"ct-participants-number\");\n                    $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[13] + '\")')\n                        .attr(\"id\", \"ct-competencies\");\n                    $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[14] + '\")')\n                        .attr(\"id\", \"ct-outcomes\");\n                    $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[15] + '\")')\n                        .attr(\"id\", \"ct-badges\");\n\n                    // Check if the plugins are installed to pass the strings. These parameters are being passed from\n                    // $initaxvars in snap/classes/output/shared.php. More validations can be added if needed.\n                    if (localJouleGrader) {\n                        $('section#coursetools ul#coursetools-list a:contains(\"' + 'Open Grader' + '\")')\n                            .attr(\"id\", \"ct-open-grader\");\n                        $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[9] + '\")')\n                            .attr(\"id\", \"ct-course-gradebook\");\n                    } else {\n                        $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[10] + '\")')\n                            .attr(\"id\", \"ct-course-gradebook\");\n                    }\n                    if (blockReports) {\n                        $('section#coursetools ul#coursetools-list a:contains(\"' + 'Open Reports' + '\")')\n                            .attr(\"id\", \"ct-open-reports\");\n                        $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[18] + '\")')\n                            .attr(\"id\", \"ct-open-reports-experimental\");\n                    }\n                    if (allyReport) {\n                        $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[16] + '\")')\n                            .attr(\"id\", \"ct-ally\");\n                    }\n                    if (localCatalogue) {\n                        $('section#coursetools ul#coursetools-list a:contains(\"' + stringsjs[17] + '\")')\n                            .attr(\"id\", \"ct-open-catalogue\");\n                    }\n\n                    // Add ARIA attributes.\n                    $('div[role=\"main\"] div.sitetopic ul.section.img-text').attr('role', 'presentation');\n                });\n\n                $(document).ready(function() {\n                    // Add necessary attributes to needed DOM elements to new accessibility features.\n                    $(\"#page-mod-data-edit input[id*='url']\").attr(\"type\", \"url\").attr(\"autocomplete\", \"url\");\n                    $(\"#moodle-blocks aside#block-region-side-pre a.sr-only.sr-only-focusable\").attr(\"tabindex\", \"-1\");\n\n                    // Focus first invalid input after a submit is done.\n                    $('.mform').submit(function() {\n                        $('input.form-control.is-invalid:first').focus();\n                    });\n\n                    // Retrieve value from the input buttons from add/remove users in a group inside a course.\n                    var addtext = $('.groupmanagementtable #buttonscell p.arrow_button input[name=\"add\"]').attr('value');\n                    var removetext = $(\".groupmanagementtable #buttonscell p.arrow_button input[name='remove']\").attr('value');\n\n                    // Snap tab panels.\n                    new Tabpanel(\"snap-pm-accessible-tab\");\n                    new Tabpanel(\"modchooser-accessible-tab\");\n\n                    // Wrapping for dropdown elements in the actionable elements in an activity for PLD.\n                    if( $(\".dropdown-item.editing_pld\").closest(\".pld-dropdown\").length == 0 ) {\n                        $(\".dropdown-item.editing_pld\").wrap(\"<li class='pld-dropdown'></li>\");\n                    }\n                    $(\".dropdown-item.editing_pld\").attr(\"role\",\"button\");\n\n                    /**\n                     * Store the references outside the event handler.\n                     * Window reload to change the inputs value for Add and Remove buttons when adding new\n                     * members to a group.\n                     */\n                    var $window = $(window);\n\n                    /**\n                     * Modifies attributes depending on the window size.\n                     */\n                    function checkWidth() {\n                        var windowsize = $window.width();\n                        if (windowsize < 1220) {\n                            $(\".groupmanagementtable #buttonscell p.arrow_button input[name='add']\").attr(\"value\", \"+\");\n                            $(\".groupmanagementtable #buttonscell p.arrow_button input[name='remove']\").attr(\"value\", \"-\");\n                        } else if (windowsize > 1220) {\n                            $(\".groupmanagementtable #buttonscell p.arrow_button input[name='add']\").attr(\"value\", addtext);\n                            $(\".groupmanagementtable #buttonscell p.arrow_button input[name='remove']\").attr(\"value\", removetext);\n                        }\n                    }\n                    // Execute on load\n                    checkWidth();\n                    // Bind event listener\n                    $(window).resize(checkWidth);\n\n                    /**\n                     * Change for the active carousel slide.\n                     */\n                    function carouselAriaCurrentValue() {\n                        var carouselindicator = $('#snap-site-carousel .carousel-indicators button');\n                        carouselindicator.click(function (e) {\n                            var element = $(e.target);\n                            carouselindicator.attr('aria-current', false);\n                            element.attr('aria-current', true);\n                        });\n\n                        /**\n                         * Listener to change aria-current value dynamically.\n                         */\n                        var targetNode = document.getElementById('snap-carousel-container');\n\n                        // Options for the observer (which mutations to observe)\n                        var config = { attributes: true, childList: true, subtree: true };\n\n                        // Callback function to execute when mutations are observed\n                        var callback = () => {\n                            $('.carousel-indicators button').attr('aria-current', false);\n                            $('.carousel-indicators button.active').attr('aria-current', true);\n                        };\n\n                        // Create an observer instance linked to the callback function\n                        var observer = new MutationObserver(callback);\n\n                        if (targetNode) {\n                            // Start observing the target node for configured mutations.\n                            observer.observe(targetNode, config);\n                        }\n                    }\n                    carouselAriaCurrentValue();\n\n                    /**\n                     * Creates a pause and resume cycles for Snap's carousel.\n                     */\n                    function carouselPausePlay() {\n                        $('#snap-site-carousel').carousel({\n                            interval: 6000,\n                            pause: \"false\"\n                        });\n\n                        $('#play-button').click(function () {\n                            $('#snap-site-carousel').carousel('cycle');\n                        });\n                        $('#pause-button').click(function () {\n                            $('#snap-site-carousel').carousel('pause');\n                        });\n                    }\n                    carouselPausePlay();\n\n                    /**\n                     * Set all the side drawers tabbing order.\n                     */\n                    function setDrawersTabOrder() {\n                        let blocksDrawerFocus;\n                        let blocksDrawerAccessed = false;\n\n                        /**\n                         * Gets both the first and the last focusable elements from a drawer.\n                         *\n                         * @param {object} drawer The drawer to be analyzed.\n                         */\n                        function getFirstAndLastOfDrawer(drawer) {\n                            let focusables = '[tabindex]:not([tabindex=\"-1\"]),' +\n                                ' a[href]:not([tabindex]),' +\n                                ' button:not([disabled]):not([tabindex]),' +\n                                ' input:not([disabled]):not([tabindex]),' +\n                                ' textarea:not([disabled]):not([tabindex]),' +\n                                ' select:not([disabled]):not([tabindex]), details:not([tabindex])';\n\n                            let first = null;\n                            let last = null;\n                            if (drawer) {\n                                let drawerFocusables = Array.from(drawer.querySelectorAll(focusables)).filter(el => {\n                                    return el.checkVisibility();\n                                });\n                                first = drawerFocusables[0];\n                                last = drawerFocusables[drawerFocusables.length - 1];\n                            }\n                            return [first, last];\n                        }\n\n                        /**\n                         * Event listener to determine keyboard navigation of the drawers.\n                         *\n                         * @param {object} ev event\n                         */\n                        function drawerTabListener(ev) {\n\n                            // Setup for the listener.\n                            let adminDrawerIcon = document.getElementById('admin-menu-trigger');\n                            let adminDrawer = adminDrawerIcon ?\n                                document.querySelector('section.block_settings[data-block=\"settings\"]') : null;\n                            let blocksDrawerIcon = document.querySelector('.blocks-drawer-button');\n                            let blocksDrawer = blocksDrawerIcon ?\n                                document.getElementById('theme_snap-drawers-blocks') : null;\n                            let blocksDrawerClose = document.querySelector('#theme_snap-drawers-blocks > .drawerheader > button');\n                            let snapfeedsDrawerIcon = document.getElementById('snap_feeds_side_menu_trigger');\n                            let snapfeedsDrawer = snapfeedsDrawerIcon ?\n                                document.querySelector('#snap_feeds_side_menu .snap-feeds') : null;\n                            let snapfeedsSideMenu = document.getElementById('snap_feeds_side_menu');\n                            let messageDrawerIcon = document.querySelector('a[id^=\\'message-drawer-toggle-\\']');\n                            let messageDrawerChild = document.querySelector('div[data-region=\"message-drawer\"]');\n                            let messageDrawer = messageDrawerChild ? messageDrawerChild.parentElement : null;\n                            messageDrawer = messageDrawerIcon ? messageDrawer : null;\n                            let messageDrawerClose = document.querySelector('[id^=\"message-drawer-\"] > div.closewidget > a');\n                            let drawerIcons = [adminDrawerIcon, blocksDrawerIcon, snapfeedsDrawerIcon, messageDrawerIcon]\n                                .filter(el => {\n                                    return el !== null;\n                                });\n                            let drawers = [adminDrawer, blocksDrawer, snapfeedsDrawer, messageDrawer]\n                                .filter(el => {\n                                    return el !== null;\n                                });\n                            // Dynamically get the last link from the custom menu header\n                            let beforeDrawers =\n                              document.querySelectorAll(\n                                \"#snap-custom-menu-header div > ul > li:not(.d-none) > a\"\n                              ) ||\n                              document.querySelectorAll(\n                                \"#snap-custom-menu-header > nav > ul > li:not(.d-none) > a\"\n                              );\n                            beforeDrawers = beforeDrawers.length > 0 ? beforeDrawers[beforeDrawers.length - 1] : null;\n                            // If custom menu header doesn't exist, get the last focusable item in snap-header\n                            if (!beforeDrawers) {\n                                let focusables = '[tabindex]:not([tabindex=\"-1\"]),' +\n                                    ' a[href]:not([tabindex]),' +\n                                    ' button:not([disabled]):not([tabindex]),' +\n                                    ' input:not([disabled]):not([tabindex]),' +\n                                    ' textarea:not([disabled]):not([tabindex]),' +\n                                    ' select:not([disabled]):not([tabindex]), details:not([tabindex])';\n                                let snapHeader = document.getElementById('snap-header');\n                                if (snapHeader) {\n                                    let headerFocusables = Array.from(snapHeader.querySelectorAll(focusables)).filter(el => {\n                                        return el.checkVisibility();\n                                    });\n                                    beforeDrawers = headerFocusables.length > 0 ?\n                                        headerFocusables[headerFocusables.length - 1] : null;\n                                }\n                            }\n                            let afterDrawers = document.querySelector('#snap-sidebar-menu > button.snap-sidebar-menu-trigger');\n\n                            let adminDrawerFirst = null;\n                            let adminDrawerLast = null;\n                            [adminDrawerFirst, adminDrawerLast] = getFirstAndLastOfDrawer(adminDrawer);\n\n                            let blocksDrawerFirst = null;\n                            let blocksDrawerLast = null;\n                            [blocksDrawerFirst, blocksDrawerLast] = getFirstAndLastOfDrawer(blocksDrawer);\n\n                            let snapfeedsDrawerFirst = null;\n                            let snapfeedsDrawerLast = null;\n                            [snapfeedsDrawerFirst, snapfeedsDrawerLast] = getFirstAndLastOfDrawer(snapfeedsDrawer);\n\n                            let messageDrawerFirst = null;\n                            let messageDrawerLast = null;\n                            [messageDrawerFirst, messageDrawerLast] = getFirstAndLastOfDrawer(messageDrawer);\n\n                            let drawerFirsts = [adminDrawerFirst, blocksDrawerFirst, snapfeedsDrawerFirst, messageDrawerFirst]\n                                .filter(el => {\n                                    return el !== null;\n                                });\n                            let drawerLasts = [adminDrawerLast, blocksDrawerLast, snapfeedsDrawerLast, messageDrawerLast]\n                                .filter(el => {\n                                    return el !== null;\n                                });\n\n                            // Process keys (Tab, Shift+Tab, and Enter).\n                            if (ev.key === 'Tab' && drawerIcons.includes(ev.target)) {\n                                ev.preventDefault();\n                                let idx = drawerIcons.indexOf(ev.target);\n                                if ((drawers[idx].classList.contains('state-visible')\n                                        && adminDrawer && drawers[idx] === adminDrawer) ||\n                                    (drawers[idx].classList.contains('show') && blocksDrawer && drawers[idx] === blocksDrawer) ||\n                                    (snapfeedsSideMenu && snapfeedsSideMenu.classList.contains('state-visible')\n                                        && snapfeedsDrawer && drawers[idx] === snapfeedsDrawer) ||\n                                    (!drawers[idx].classList.contains('hidden')\n                                        && messageDrawer && drawers[idx] === messageDrawer)) {\n                                    if (ev.shiftKey) {\n                                        drawerLasts[idx].focus();\n                                    } else {\n                                        drawerFirsts[idx].focus();\n                                    }\n                                } else {\n                                    if (ev.shiftKey) {\n                                        if (idx === 0) {\n                                            beforeDrawers.focus();\n                                        } else {\n                                            drawerIcons[idx - 1].focus();\n                                        }\n                                    } else {\n                                        if (idx < drawers.length - 1) {\n                                            drawerIcons[idx + 1].focus();\n                                        } else {\n                                            afterDrawers.focus();\n                                        }\n                                    }\n                                }\n                            } else if (ev.key === 'Tab' && !ev.shiftKey && drawerLasts.includes(ev.target)) {\n                                ev.preventDefault();\n                                let idx = drawerLasts.indexOf(ev.target);\n                                drawerIcons[idx].focus();\n                            } else if (ev.key === 'Tab' && ev.shiftKey && drawerFirsts.includes(ev.target)) {\n                                ev.preventDefault();\n                                let idx = drawerFirsts.indexOf(ev.target);\n                                drawerIcons[idx].focus();\n                            } else if (ev.key === 'Enter' && (drawerIcons.includes(ev.target)\n                                || messageDrawerClose === ev.target)) {\n                                blocksDrawerAccessed = false;\n                                ev.preventDefault();\n                                let idx = drawerIcons.indexOf(ev.target);\n                                if (drawerIcons[idx] === messageDrawerIcon) {\n                                    document.getElementById('page').classList.toggle('offcanvas');\n                                } else if (drawerIcons[idx] === blocksDrawerIcon) {\n                                    drawerIcons[idx].click();\n                                    blocksDrawerFocus = function() {\n                                        if (blocksDrawerAccessed) {\n                                            return;\n                                        } else {\n                                            blocksDrawerAccessed = true;\n                                        }\n                                        blocksDrawerIcon.focus();\n                                        blocksDrawerClose.removeEventListener('focus', blocksDrawerFocus);\n                                    };\n                                    blocksDrawerClose.addEventListener('focus', blocksDrawerFocus);\n                                } else if (messageDrawerClose !== ev.target) {\n                                    drawerIcons[idx].click();\n                                } else {\n                                    document.getElementById('page').classList.toggle('offcanvas');\n                                    messageDrawerIcon.focus();\n                                }\n                                if (idx >= 0) {\n                                    drawerIcons[idx].focus();\n                                }\n                            }\n                        }\n                        document.addEventListener('keydown', drawerTabListener);\n                    }\n                    setDrawersTabOrder();\n\n                    // Local accessibility plugin button from Snap header\n                    const accessibilityIcon = document.getElementById('local-accessibility-buttoncontainer');\n                    const headerButtonsContainer = document.querySelector('#snap-header > div.float-end');\n                    if (accessibilityIcon && headerButtonsContainer.querySelector('.usermenu')) {\n                        const lineSeparator = document.querySelector('#snap-header div.snap_line_separator');\n                        const accessibilityWrapper = document.createElement('div');\n                        accessibilityWrapper.id = 'nav-local-accessibility-popover-container';\n                        const accessibilityPanel = document.querySelector('div.local-accessibility-panel');\n                        accessibilityPanel.classList.remove('border-primary');\n                        accessibilityPanel.classList.remove('card');\n                        accessibilityIcon.querySelector('button').addEventListener('focus', () => {\n                            accessibilityWrapper.classList.add('focused-icon');\n                        });\n                        accessibilityIcon.querySelector('button').addEventListener('blur', () => {\n                            accessibilityWrapper.classList.remove('focused-icon');\n                        });\n                        const userMenuLink = document.querySelector('.usermenu a');\n                        if (userMenuLink) {\n                            userMenuLink.addEventListener('click', () => {\n                                accessibilityPanel.style.display = 'none';\n                            });\n                        }\n\n                        if (lineSeparator) {\n                            lineSeparator.parentElement.insertBefore(accessibilityWrapper, lineSeparator);\n                        } else {\n                            headerButtonsContainer.insertBefore(accessibilityWrapper, lineSeparator);\n                        }\n                        accessibilityWrapper.appendChild(accessibilityIcon);\n                        accessibilityWrapper.appendChild(accessibilityPanel);\n\n                        let animationTimeout = null;\n                        let isClosingAnim = false;\n\n                        /**\n                         * Handles opening animation for accessibility panel.\n                         */\n                        const handlePanelOpen = () => {\n                            // Clear any pending close animations\n                            if (animationTimeout) {\n                                clearTimeout(animationTimeout);\n                                animationTimeout = null;\n                            }\n\n                            accessibilityPanel.style.display = 'block';\n                            requestAnimationFrame(() => {\n                                accessibilityPanel.classList.add('is-visible');\n                            });\n                        };\n\n                        /**\n                         * Handles closing animation for accessibility panel.\n                         */\n                        const handlePanelClose = () => {\n                            if (isClosingAnim) {\n                                return;\n                            }\n                            isClosingAnim = true;\n                            accessibilityPanel.style.display = 'block';\n\n                            requestAnimationFrame(() => {\n                                accessibilityPanel.classList.remove('is-visible');\n                                animationTimeout = setTimeout(() => {\n                                    if (isClosingAnim && !accessibilityPanel.classList.contains('is-visible')) {\n                                        accessibilityPanel.style.display = 'none';\n                                    }\n                                    isClosingAnim = false;\n                                    animationTimeout = null;\n                                }, 300);\n                            });\n                        };\n\n                        // Required to apply the required transition in the Snap header\n                        const observer = new MutationObserver(() => {\n                            const isDisplayed = window.getComputedStyle(accessibilityPanel).display !== 'none';\n                            const isVisible = accessibilityPanel.classList.contains('is-visible');\n                            if (isDisplayed && !isVisible) {\n                                handlePanelOpen();\n                            }\n                            if (!isDisplayed && isVisible) {\n                                handlePanelClose();\n                            }\n                        });\n\n                        observer.observe(accessibilityPanel, {attributes: true, attributeFilter: ['style']});\n                    }\n\n                    const snapCustomheader = document.getElementById('snap-custom-menu-header');\n                    const menu = document.querySelector('.snap-navbar-content');\n                    if (menu && snapCustomheader) {\n                        try {\n                            coreMoreMenu(menu);\n                        } catch (e) {\n                            menu.classList.add('flex-nowrap');\n                            log.error(e);\n                        } finally {\n                            if (snapCustomheader.classList.contains('invisible')) {\n                                snapCustomheader.classList.remove('invisible');\n                            }\n                        }\n                    }\n                });\n\n                /**\n                 * Add needed accessibility for tabs inside Snap.\n                 * This makes use of Bootstrap accessible tab panel with WAI-ARIA with the arrow keys binding codes.\n                 * @param {string} id\n                 */\n                function Tabpanel(id) {\n                    this._id = id;\n                    this.$tpanel = $('#' + id);\n                    this.$tabs = this.$tpanel.find('.tab');\n                    this.$panels = this.$tpanel.find('.tab-pane');\n                    this.bindHandlers();\n                    this.init();\n                }\n\n                Tabpanel.prototype.keys = {\n                    left: 37,\n                    up: 38,\n                    right: 39,\n                    down: 40\n                };\n\n                Tabpanel.prototype.init = function() {\n                    var $tab;\n                    this.$panels.attr('aria-hidden', 'true');\n                    this.$panels.removeClass('active in');\n                    $tab = this.$tabs.filter('.active');\n                    if ($tab === undefined) {\n                        $tab = this.$tabs.first();\n                        $tab.addClass('active');\n                    }\n                    this.$tpanel\n                        .find('#' + $tab.find('a').attr('aria-controls'))\n                        .addClass('active in').attr('aria-hidden', 'false');\n                };\n\n                Tabpanel.prototype.switchTabs = function($curTab, $newTab) {\n                    var $curTabLink = $curTab.find('a'),\n                        $newTabLink = $newTab.find('a');\n                    $curTab.removeClass('active');\n                    $curTabLink.attr('tabindex', '-1').attr('aria-selected', 'false');\n                    $newTab.addClass('active');\n                    $newTabLink.attr('aria-selected', 'true');\n                    this.$tpanel\n                        .find('#' + $curTabLink.attr('aria-controls'))\n                        .removeClass('active in').attr('aria-hidden', 'true');\n                    this.$tpanel\n                        .find('#' + $newTabLink.attr('aria-controls'))\n                        .addClass('active in').attr('aria-hidden', 'false');\n                    $newTabLink.attr('tabindex', '0');\n                    $newTabLink.focus();\n                };\n\n                Tabpanel.prototype.bindHandlers = function() {\n                    var self = this;\n                    this.$tabs.keydown(function(e) {\n                        return self.handleTabKeyDown($(this), e);\n                    });\n                    this.$tabs.click(function(e) {\n                        return self.handleTabClick($(this), e);\n                    });\n                };\n\n                Tabpanel.prototype.handleTabKeyDown = function($tab, e) {\n                    var $newTab, tabIndex;\n                    switch (e.keyCode) {\n                        case this.keys.left:\n                        case this.keys.up: {\n                            tabIndex = this.$tabs.index($tab);\n                            if (tabIndex === 0) {\n                                $newTab = this.$tabs.last();\n                            } else {\n                                $newTab = this.$tabs.eq(tabIndex - 1);\n                            }\n                            this.switchTabs($tab, $newTab);\n                            e.preventDefault();\n                            return false;\n                        }\n                        case this.keys.right:\n                        case this.keys.down: {\n                            tabIndex = this.$tabs.index($tab);\n                            if (tabIndex === this.$tabs.length - 1) {\n                                $newTab = this.$tabs.first();\n                            } else {\n                                $newTab = this.$tabs.eq(tabIndex + 1);\n                            }\n                            this.switchTabs($tab, $newTab);\n                            e.preventDefault();\n                            return false;\n                        }\n                    }\n                };\n\n                Tabpanel.prototype.handleTabClick = function($tab) {\n                    var $oldTab = this.$tpanel.find('.tab.active');\n                    this.switchTabs($oldTab, $tab);\n                };\n            },\n\n            /**\n             * Override the options from theme_boost/loader::enablePopovers to enhance accesibility (VPAT).\n             */\n            setManualPopovers: function() {\n                const btnSelector = '.iconhelp.btn';\n\n                $('body').popover({\n                    selector: '[data-toggle=\"popover\"]',\n                    trigger: 'manual',\n                    container: 'body',\n                    whitelist: Object.assign(DefaultWhitelist, {\n                        table: [],\n                        thead: [],\n                        tbody: [],\n                        tr: [],\n                        th: [],\n                        td: [],\n                    }),\n                });\n\n                // Prevent Bootstrap from automatically reacting to button focus\n                $(btnSelector).on('focusin', function(e) {\n                    e.stopImmediatePropagation();\n                });\n\n                $(btnSelector).on('click', function(e) {\n                    e.preventDefault();\n                    e.stopImmediatePropagation();\n\n                    const $el = $(this);\n                    const isOpen = $el.attr('aria-expanded') === 'true';\n\n                    if (isOpen) {\n                        $el.popover('hide');\n                    } else {\n                        $el.popover('show');\n                    }\n                });\n\n                $(btnSelector).on('keydown', function(e) {\n                    const $el = $(this);\n\n                    if (e.key === 'Enter' || e.key === ' ') {\n                        e.preventDefault();\n                        e.stopImmediatePropagation();\n\n                        const isOpen = $el.attr('aria-expanded') === 'true';\n\n                        if (isOpen) {\n                            $el.popover('hide');\n                        } else {\n                            $el.popover('show');\n                        }\n                    }\n\n                    if (e.key === 'Escape') {\n                        $el.popover('hide');\n                    }\n                });\n\n                $(btnSelector).on('shown.bs.popover', function () {\n                    const popover = $(this).data('bs.popover').tip;\n                    $(this).attr('aria-controls', popover.id);\n                    $(this).attr('aria-expanded', true);\n                    $(popover).insertAfter($(this));\n                    $(popover).popover('update');\n                });\n\n                $(btnSelector).on('hidden.bs.popover', function () {\n                    $(this).attr('aria-expanded', false);\n                });\n            }\n\n        };\n    }\n);\n"],"names":["define","$","str","Event","FormEvents","Popover","coreMoreMenu","log","DefaultWhitelist","snapAxInit","localJouleGrader","allyReport","blockReports","localCatalogue","Tabpanel","id","_id","$tpanel","$tabs","this","find","$panels","bindHandlers","init","get_strings","key","component","done","stringsjs","attr","parent","searchbutton","title","expr","contains","createPseudo","arg","elem","text","toUpperCase","indexOf","ctparticipantsnumber","split","document","ready","submit","focus","addtext","removetext","closest","length","wrap","$window","window","checkWidth","windowsize","width","resize","carouselindicator","click","e","element","target","targetNode","getElementById","observer","MutationObserver","observe","attributes","childList","subtree","carouselAriaCurrentValue","carousel","interval","pause","blocksDrawerFocus","blocksDrawerAccessed","getFirstAndLastOfDrawer","drawer","first","last","drawerFocusables","Array","from","querySelectorAll","filter","el","checkVisibility","addEventListener","ev","adminDrawerIcon","adminDrawer","querySelector","blocksDrawerIcon","blocksDrawer","blocksDrawerClose","snapfeedsDrawerIcon","snapfeedsDrawer","snapfeedsSideMenu","messageDrawerIcon","messageDrawerChild","messageDrawer","parentElement","messageDrawerClose","drawerIcons","drawers","beforeDrawers","focusables","snapHeader","headerFocusables","afterDrawers","adminDrawerFirst","adminDrawerLast","blocksDrawerFirst","blocksDrawerLast","snapfeedsDrawerFirst","snapfeedsDrawerLast","messageDrawerFirst","messageDrawerLast","drawerFirsts","drawerLasts","includes","preventDefault","idx","classList","shiftKey","toggle","removeEventListener","setDrawersTabOrder","accessibilityIcon","headerButtonsContainer","lineSeparator","accessibilityWrapper","createElement","accessibilityPanel","remove","add","userMenuLink","style","display","insertBefore","appendChild","animationTimeout","isClosingAnim","handlePanelOpen","clearTimeout","requestAnimationFrame","handlePanelClose","setTimeout","isDisplayed","getComputedStyle","isVisible","attributeFilter","snapCustomheader","menu","error","prototype","keys","left","up","right","down","$tab","removeClass","undefined","addClass","switchTabs","$curTab","$newTab","$curTabLink","$newTabLink","self","keydown","handleTabKeyDown","handleTabClick","tabIndex","keyCode","index","eq","$oldTab","setManualPopovers","popover","selector","trigger","container","whitelist","Object","assign","table","thead","tbody","tr","th","td","on","stopImmediatePropagation","$el","data","tip","insertAfter"],"mappings":"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"}