{"version":3,"sources":["../src/footer_alert.js"],"names":["define","$","templates","FooterAlert","containerEl","document","ready","detach","length","render","done","result","append","setTitle","titleHTML","html","setSrNotice","focus","srText","find","addAjaxLoading","str","M","util","get_string","titleEl","removeAjaxLoading","remove","show","onCancel","prependTo","addClass","click","removeClass","hide","hideAndReset"],"mappings":"AAsBAA,OAAM,2BAAC,CAAC,QAAD,CAAW,gBAAX,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAuB,CA0GnB,MAAO,IAzGW,SAAdC,CAAAA,WAAc,EAAW,CAGzB,GAAIC,CAAAA,CAAJ,CAMAH,CAAC,CAACI,QAAD,CAAD,CAAYC,KAAZ,CAAkB,UAAW,CACzBF,CAAW,CAACG,MAAZ,EACH,CAFD,EAOA,CAAC,UAAW,CACRH,CAAW,CAAGH,CAAC,CAAC,oBAAD,CAAf,CAIA,GAA2B,CAAvB,GAAAG,CAAW,CAACI,MAAhB,CAA8B,CAC1BN,CAAS,CAACO,MAAV,CAAiB,yBAAjB,CAA4C,EAA5C,EACKC,IADL,CACU,SAASC,CAAT,CAAiB,CACnBV,CAAC,CAAC,cAAD,CAAD,CAAkBW,MAAlB,CAAyBD,CAAzB,EACAP,CAAW,CAAGH,CAAC,CAAC,oBAAD,CAClB,CAJL,CAKH,CACJ,CAZD,IAkBA,KAAKY,QAAL,CAAgB,SAASC,CAAT,CAAoB,CAChCb,CAAC,CAAC,0BAAD,CAAD,CAA8Bc,IAA9B,CAAmCD,CAAnC,EACA,KAAKE,WAAL,CAAiB,EAAjB,EAEAZ,CAAW,CAACa,KAAZ,EACH,CALD,CAWA,KAAKD,WAAL,CAAmB,SAASE,CAAT,CAAiB,CAChCd,CAAW,CAACe,IAAZ,CAAiB,WAAjB,EAA8BJ,IAA9B,CAAmCG,CAAnC,CACH,CAFD,CAQA,KAAKE,cAAL,CAAsB,SAASC,CAAT,CAAc,CAChCA,CAAG,CAAG,CAACA,CAAD,CAAOC,CAAC,CAACC,IAAF,CAAOC,UAAP,CAAkB,SAAlB,CAA6B,YAA7B,CAAP,CAAoDH,CAA1D,CACA,GAAII,CAAAA,CAAO,CAAGxB,CAAC,CAAC,0BAAD,CAAf,CACA,GAA4C,CAAxC,GAAAwB,CAAO,CAACN,IAAR,CAAa,cAAb,EAA6BX,MAAjC,CAA+C,CAC3CiB,CAAO,CAACb,MAAR,CAAe,sDACJS,CADI,CACE,SADjB,CAEH,CACJ,CAPD,CAYA,KAAKK,iBAAL,CAAyB,UAAW,CAChCtB,CAAW,CAACe,IAAZ,CAAiB,cAAjB,EAAiCQ,MAAjC,EACH,CAFD,CAQA,KAAKC,IAAL,CAAY,SAASC,CAAT,CAAmB,CAE3BzB,CAAW,CAAC0B,SAAZ,CAAsB,qBAAtB,EACA1B,CAAW,CAAC2B,QAAZ,CAAqB,2BAArB,EACA,GAA0B,UAAtB,QAAQF,CAAAA,CAAZ,CAAsC,CAClC5B,CAAC,CAAC,2BAAD,CAAD,CAA+B+B,KAA/B,CAAqCH,CAArC,EACA5B,CAAC,CAAC,2BAAD,CAAD,CAA+B8B,QAA/B,CAAwC,eAAxC,CACH,CAHD,IAGO,CACH9B,CAAC,CAAC,2BAAD,CAAD,CAA+BgC,WAA/B,CAA2C,eAA3C,CACH,CACJ,CAVD,CAeA,KAAKC,IAAL,CAAY,UAAW,CACnB9B,CAAW,CAAC6B,WAAZ,CAAwB,2BAAxB,EACAhC,CAAC,CAAC,2BAAD,CAAD,CAA+BgC,WAA/B,CAA2C,eAA3C,EAEA7B,CAAW,CAACG,MAAZ,EACH,CALD,CAUA,KAAK4B,YAAL,CAAoB,UAAW,CAC3B,KAAKT,iBAAL,GACA,KAAKb,QAAL,CAAc,EAAd,EACA,KAAKG,WAAL,CAAiB,EAAjB,EACA,KAAKkB,IAAL,EACH,CACJ,CAEJ,CA5GC,CAAN","sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package   theme_snap\n * @author    Guy Thomas <osdev@blackboard.com>\n * @copyright Copyright (c) 2016 Blackboard Inc.\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/templates'],\n    function($, templates) {\n        var FooterAlert = function() {\n\n            // Container.\n            var containerEl;\n\n            /**\n             * Detach the container for footer alert, so it will not appear at the first load of the page,\n             * this to fix AX problems with unnecessary empty tags.\n             */\n            $(document).ready(function() {\n                containerEl.detach();\n            });\n\n            /**\n             * Initialising function.\n             */\n            (function() {\n                containerEl = $('#snap-footer-alert');\n\n                // If the move notice html was not output to the dom via php, then we need to add it here via js.\n                // This is necessary for the front page which does not have a renderer that we can override.\n                if (containerEl.length === 0) {\n                    templates.render('theme_snap/footer_alert', {})\n                        .done(function(result) {\n                            $('#region-main').append(result);\n                            containerEl = $('#snap-footer-alert');\n                        });\n                }\n            })();\n\n            /**\n             * Set title element html.\n             * @param {string} titleHTML\n             */\n            this.setTitle = function(titleHTML) {\n                $('.snap-footer-alert-title').html(titleHTML);\n                this.setSrNotice('');\n                    // Focus on container so that it get's red out for accessibility reasons.\n                containerEl.focus();\n            };\n\n            /**\n             * Set screen reader notice.\n             * @param {string} srText\n             */\n            this.setSrNotice = function(srText) {\n                containerEl.find('p.sr-only').html(srText);\n            };\n\n            /**\n             * Add AJAX loading spinner.\n             * @param {string} str\n             */\n            this.addAjaxLoading = function(str) {\n                str = !str ? M.util.get_string('loading', 'theme_snap') : str;\n                var titleEl = $('.snap-footer-alert-title');\n                if (titleEl.find('.loadingstat').length === 0) {\n                    titleEl.append('<span class=\"loadingstat spinner-three-quarters' +\n                        '\">' + str + '</span>');\n                }\n            };\n\n            /**\n             * Remove AJAX loading spinner.\n             */\n            this.removeAjaxLoading = function() {\n                containerEl.find('.loadingstat').remove();\n            };\n\n            /**\n             * Show footer alert.\n             * @param {function} onCancel\n             */\n            this.show = function(onCancel) {\n                // Re-attach Snap footer alert, so it appears when moving an activity or a section.\n                containerEl.prependTo('section#region-main');\n                containerEl.addClass('snap-footer-alert-visible');\n                if (typeof (onCancel) === 'function') {\n                    $('.snap-footer-alert-cancel').click(onCancel);\n                    $('.snap-footer-alert-cancel').addClass('state-visible');\n                } else {\n                    $('.snap-footer-alert-cancel').removeClass('state-visible');\n                }\n            };\n\n            /**\n             * Hide footer alert.\n             */\n            this.hide = function() {\n                containerEl.removeClass('snap-footer-alert-visible');\n                $('.snap-footer-alert-cancel').removeClass('state-visible');\n                // Detach Snap footer alert after cancel button (When hiding the alert).\n                containerEl.detach();\n            };\n\n            /**\n             * Hide footer alert and reset content.\n             */\n            this.hideAndReset = function() {\n                this.removeAjaxLoading();\n                this.setTitle('');\n                this.setSrNotice('');\n                this.hide();\n            };\n        };\n        return new FooterAlert();\n    }\n);\n"],"file":"footer_alert.min.js"}